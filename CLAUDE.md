# Challenge Backend

## Project Overview
- **Name**: challenge-backend
- **Type**: FastAPI serverless backend
- **Runtime**: Python 3.12
- **Framework**: FastAPI + Mangum (for AWS Lambda)
- **Deployment**: AWS Serverless (using Serverless Framework)

## Project Structure
```
challenge-backend/
├── main.py                  # FastAPI application entry point (root level)
├── __init__.py              # Makes root a Python package
├── infra/
│   ├── package.json         # Serverless plugin dependencies
│   ├── package-lock.json
│   └── serverless.yml       # Serverless Framework configuration
├── Dockerfile               # Docker containerization
├── docker-compose.yml       # Docker Compose configuration
├── pyproject.toml           # Python project configuration
├── requirements.txt         # Python dependencies (auto-generated by uv)
├── uv.lock                  # UV lockfile
├── CLAUDE.md               # Project documentation
└── README.md
```

## Technology Stack
- **Python**: 3.12+
- **Web Framework**: FastAPI 0.116.1
- **ASGI Adapter**: Mangum 0.19.0 (for AWS Lambda)
- **ASGI Server**: Uvicorn 0.35.0
- **Package Manager**: UV
- **Infrastructure**: Serverless Framework
- **Cloud Provider**: AWS (ap-northeast-2 region)

## Development Commands

### Python Environment
```bash
# Install dependencies
uv sync

# Run locally (development) - main.py is in root directory
uv run uvicorn main:app --host 0.0.0.0 --port 8000 --reload

# Run with custom port
uv run uvicorn main:app --host 0.0.0.0 --port 3000 --reload

# Add new dependency
uv add <package-name>
```

### Docker Commands
```bash
# Build Docker image
docker build -t backend:latest .

# Run with Docker Compose
docker-compose up -d

# Run Docker container directly
docker run -p 8000:8000 backend:latest
```

### Serverless Deployment

#### Manual Deployment
```bash
# Install serverless dependencies
cd infra && npm install

# Deploy to dev stage
cd infra && make deploy-dev

# Deploy to production stage
cd infra && make deploy-prod

# Remove deployment
cd infra && make remove-dev
cd infra && make remove-prod
```

#### Automated Deployment (CI/CD)
- **Dev → Prod**: PR merge to `main` branch automatically deploys to production
- **Versioning**: `v2024.09.02-abc1234` format (date + commit hash)
- **GitHub Release**: Automatically created with deployment info
- **Health Check**: Automatic API health validation after deployment

**Required GitHub Secrets:**
- `AWS_ACCESS_KEY_ID`: AWS access key
- `AWS_SECRET_ACCESS_KEY`: AWS secret key
- `SERVERLESS_ACCESS_KEY`: Serverless Framework access token
- `SERVERLESS_ORG`: Serverless organization name

## API Endpoints
- `GET /health` - Health check endpoint

## Configuration
- **AWS Region**: ap-northeast-2 (Seoul)
- **Default Stage**: dev
- **Lambda Handler**: ../src/main.handler
- **Python Requirements**: Uses Docker for pip installation